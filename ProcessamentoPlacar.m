 numeros{10}= [6     4;
     5     5;
     5     6;
     6     7;
     7     7;
     8     7;
     9     7;
    10     8;
    11     9;
    11    10;
    11    11;
    12    11;
    12    10;
    12     9;
    11     8;
    11     7;
    10     6;
     9     5;
     8     5;
     7     5;
     6     4];
 
 
 numeros{1} = [ 11     6;
    11     7;
    11     8;
    10     9;
     9     9;
     8     9;
     7     9;
     6     9;
     5     8;
     4     7;
     4     8;
     3     9;
     3    10;
     3    11;
     4    11;
     5    11;
     6    11;
     7    11;
     8    11;
     9    11;
    10    11;
    11    12;
    11    13;
    12    13;
    12    12;
    12    11;
    12    10;
    12     9;
    12     8;
    12     7;
    11     6];


numeros{2}=[4     5;
     3     6;
     3     7;
     2     8;
     2     9;
     2    10;
     2    11;
     3    12;
     3    13;
     4    14;
     5    14;
     6    14;
     7    13;
     8    12;
     9    11;
     9    10;
    10     9;
    11    10;
    11    11;
    11    12;
    11    13;
    11    14;
    12    14;
    12    13;
    12    12;
    12    11;
    12    10;
    12     9;
    12     8;
    12     7;
    12     6;
    11     5;
    10     5;
     9     6;
     8     7;
     7     8;
     7     9;
     7    10;
     6    11;
     5    12;
     4    13;
     3    12;
     3    11;
     3    10;
     3     9;
     3     8;
     4     7;
     4     6;
     4     5];



numeros{3} =[10     4;
    10     5;
    10     6;
    11     7;
    11     8;
    11     9;
    11    10;
    11    11;
    10    12;
     9    12;
     8    11;
     7    10;
     7     9;
     7     8;
     7     7;
     7     8;
     6     9;
     5    10;
     4    10;
     3     9;
     3     8;
     3     7;
     3     6;
     2     7;
     2     8;
     2     9;
     2    10;
     2    11;
     2    12;
     3    13;
     3    14;
     4    13;
     5    12;
     6    11;
     7    12;
     8    13;
     8    14;
     9    14;
    10    14;
    11    13;
    12    12;
    12    11;
    12    10;
    12     9;
    12     8;
    12     7;
    11     6;
    10     5;
    10     4];

numeros{4}=[6     3;
     5     4;
     4     5;
     3     6;
     2     7;
     1     8;
     1     9;
     1    10;
     1    11;
     2    11;
     3    11;
     4    11;
     5    11;
     6    11;
     7    12;
     8    13;
     9    12;
    10    11;
    11    11;
    11    10;
    11     9;
    10     9;
     9     9;
     8     8;
     8     7;
     8     6;
     8     5;
     8     4;
     8     3;
     7     3;
     6     3];
 
 numeros{5}=[1     2;
     1     3;
     1     4;
     1     5;
     1     6;
     1     7;
     1     8;
     1     9;
     1    10;
     2    10;
     2     9;
     2     8;
     2     7;
     2     6;
     2     5;
     3     4;
     4     5;
     4     6;
     4     7;
     4     8;
     4     9;
     4    10;
     5    11;
     6    12;
     7    12;
     8    12;
     9    12;
    10    12;
    11    11;
    11    10;
    11     9;
    11     8;
    11     7;
    11     6;
    11     5;
    11     4;
    10     3;
     9     2;
     9     3;
     9     4;
    10     5;
    10     6;
    10     7;
    10     8;
    10     9;
     9    10;
     8    10;
     7    10;
     6    10;
     5     9;
     5     8;
     5     7;
     5     6;
     5     5;
     5     4;
     5     3;
     5     2;
     4     2;
     3     2;
     2     2;
     1     2];
 
 numeros{6} = [4     2;
     4     3;
     3     4;
     2     5;
     1     5;
     1     6;
     1     7;
     1     8;
     1     9;
     1    10;
     2    10;
     2     9;
     2     8;
     2     7;
     3     6;
     4     5;
     5     5;
     6     6;
     6     7;
     6     8;
     6     9;
     6    10;
     6    11;
     7    12;
     8    12;
     9    12;
    10    12;
    11    11;
    11    10;
    11     9;
    11     8;
    11     7;
    11     6;
    11     5;
    11     4;
    10     3;
     9     2;
     8     2;
     7     2;
     6     2;
     5     2;
     4     2];
 
 
 numeros{7} = [3     4;
     2     5;
     2     6;
     2     7;
     2     8;
     2     9;
     2    10;
     2    11;
     2    12;
     2    13;
     2    14;
     3    14;
     4    14;
     5    13;
     6    12;
     7    11;
     8    10;
     9    10;
    10    10;
    11    10;
    12     9;
    11     8;
    10     8;
     9     8;
     8     8;
     7     9;
     7    10;
     6    11;
     5    12;
     4    12;
     3    11;
     3    10;
     3     9;
     3     8;
     4     7;
     4     6;
     4     5;
     3     4];
 
 
 numeros{8}= [3     3;
     2     4;
     1     5;
     1     6;
     1     7;
     1     8;
     1     9;
     2    10;
     3    11;
     4    11;
     5    11;
     6    10;
     7    11;
     7    12;
     8    13;
     9    13;
    10    12;
    11    11;
    11    10;
    11     9;
    11     8;
    11     7;
    11     6;
    11     5;
    10     4;
    10     3;
     9     3;
     8     3;
     7     3;
     6     4;
     5     3;
     4     3;
     3     3];
 
 
 
 numeros{9}= [4     5;
     3     6;
     3     7;
     2     8;
     2     9;
     2    10;
     2    11;
     3    12;
     3    13;
     4    14;
     5    14;
     6    14;
     7    14;
     8    14;
     9    14;
    10    13;
    11    12;
    11    11;
    12    10;
    12     9;
    12     8;
    12     7;
    11     7;
    11     8;
    11     9;
    11    10;
    10    11;
     9    12;
     8    11;
     7    10;
     7     9;
     7     8;
     7     7;
     7     6;
     6     5;
     5     5;
     4     5];
 

 

 
original = imread('C:\Users\Rafael\Documents\MATLAB\ProcessamentoPlacar\2860.png');
placarImg = imcrop(original,[109 39 104 13]);
absTol = 4;   
relTol = 2;
numberImg = imcrop(placarImg,[78 0 13 13]);
imshow(numberImg);
brancos = numberImg(:,:,1) >= 90;
imshow(brancos);

%for l = 0:12:96 

    [B,L] = bwboundaries(brancos, 'noholes');
    stats = regionprops(L, 'Area');
    qtd_numeros = sum([stats.Area] > 25);
    if qtd_numeros > 0
        placar = 0;


        hold on 
        for k = 1:length(B)
            area = stats(k).Area;    
            if area > 25
               disp(B{k});
               for i=1:length(numeros)
                   same = 0;
                   if length(B{k}) == length(numeros{i})
                       absError = B{k}(:)- numeros{i}(:);
                       relError = absError./B{k}(:);
                       relError(~isfinite(relError)) = 0;
                       same = all( (abs(absError) < absTol) & (abs(relError) < relTol) );

                   elseif abs(length(B{k})- length(numeros{i})) < 3
                       if length(B{k})> length(numeros{i})
                            absError = B{k}(1:length(numeros{i}))- numeros{i}(1:length(numeros{i}));
                            relError = absError./B{k}(1:length(numeros{i}));
                            relError(~isfinite(relError)) = 0;
                            same = all( (abs(absError) < absTol) & (abs(relError) < relTol) );
                       else 
                           absError = B{k}(1:length(B{k})) - numeros{i}(1:length(B{k}));
                           relError = absError./B{k}(1:length(B{k}));
                           relError(~isfinite(relError)) = 0;
                           same = all( (abs(absError) < absTol) & (abs(relError) < relTol) );
                       end 

                   end    

                   if same
                       if i ~= 10
                          placar = placar + i * 10^(qtd_numeros-1); 
                       end
                          qtd_numeros = qtd_numeros - 1;
                          break;
                   end
               end 
            end
        end
        hold off
        disp(placar);
        %nome = sprintf('C:/Users/Rafael/Documents/MATLAB/ProcessamentoPlacar/%d_na_posicao_%d.txt',placar,l/12);
        %fp = fopen(nome,'a'); 
        %fprintf(fp,'%d \n\n', numberImg(:,:,1));
        %fprintf(fp,'%d \n\n', numberImg(:,:,2));
        %fprintf(fp,'%d \n\n', numberImg(:,:,3));
        %fclose(fp);
        
    end
%end 


